<script>
  console.log("Debug redemoinho ‚Äî vers√£o c√¢mera afastada");

  // ===== CONFIG B√ÅSICA =====
  const canvas = document.getElementById('bg-canvas');
  const renderer = new THREE.WebGLRenderer({
    canvas,
    antialias: true,
    alpha: false
  });
  renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
  renderer.setClearColor(0x050816, 1); // fundo escuro

  const scene = new THREE.Scene();

  const camera = new THREE.PerspectiveCamera(
    45,
    window.innerWidth / window.innerHeight,
    0.1,
    100
  );
  camera.position.set(0, 0.4, 6.0);   // üîπ afastamos bem a c√¢mera

  // ===== LUZ MAIS SUAVE =====
  const ambient = new THREE.AmbientLight(0xffffff, 0.7);
  scene.add(ambient);

  const dirLight = new THREE.DirectionalLight(0xffffff, 1.0);
  dirLight.position.set(2.5, 4, 3.5);
  scene.add(dirLight);

  // ===== GRUPO DO REDEMOINHO =====
  const swirlGroup = new THREE.Group();
  scene.add(swirlGroup);

  // üîπ menor escala geral
  swirlGroup.scale.set(1.4, 1.4, 1.4);
  swirlGroup.rotation.x = -0.35;

  // ===== GEOMETRIA DO SUSPIRO (MENOR) =====
  const suspiroGeo = new THREE.ConeGeometry(0.15, 0.45, 28); // üîπ menor
  suspiroGeo.translate(0, 0.225, 0);
  suspiroGeo.rotateX(Math.PI);

  const pastelPalette = [
    new THREE.Color(0xfff4fb),
    new THREE.Color(0xffc4e1),
    new THREE.Color(0xfff0c2),
    new THREE.Color(0xc9fff0),
    new THREE.Color(0xded6ff)
  ];

  const suspiros = [];
  const count = 90; // um pouco mais, mas menores

  for (let i = 0; i < count; i++) {
    const color = pastelPalette[Math.floor(Math.random() * pastelPalette.length)];

    const material = new THREE.MeshStandardMaterial({
      color,
      roughness: 0.35,
      metalness: 0.2,
      emissive: color.clone().multiplyScalar(0.3),
      emissiveIntensity: 0.6 // üîπ menos "estourado"
    });

    const mesh = new THREE.Mesh(suspiroGeo, material);

    const t = i / count;
    const turns = 3.0;
    const angle = t * turns * Math.PI * 2;

    const baseRadius = 0.3;
    const radius = baseRadius + t * 0.7; // üîπ vortex mais largo
    const height = (t - 0.5) * 1.3;

    mesh.position.set(
      Math.cos(angle) * radius,
      height,
      Math.sin(angle) * radius
    );

    mesh.position.x += (Math.random() - 0.5) * 0.04;
    mesh.position.y += (Math.random() - 0.5) * 0.04;
    mesh.position.z += (Math.random() - 0.5) * 0.04;

    mesh.rotation.y = Math.random() * Math.PI * 2;

    swirlGroup.add(mesh);
    suspiros.push({
      mesh,
      baseY: mesh.position.y,
      offset: Math.random() * Math.PI * 2
    });
  }

  // ===== RESIZE =====
  function onResize() {
    const width = window.innerWidth;
    const height = window.innerHeight;
    renderer.setSize(width, height);
    camera.aspect = width / height;
    camera.updateProjectionMatrix();
  }
  window.addEventListener('resize', onResize);
  onResize();

  // ===== MOUSE =====
  const mouse = new THREE.Vector2(0, 0);
  window.addEventListener('mousemove', (e) => {
    const x = (e.clientX / window.innerWidth) * 2 - 1;
    const y = (e.clientY / window.innerHeight) * 2 - 1;
    mouse.set(x, y);
  });

  const clock = new THREE.Clock();

  function animate() {
    requestAnimationFrame(animate);
    const t = clock.getElapsedTime();

    // rota√ß√£o do redemoinho
    swirlGroup.rotation.y = t * 0.22;

    // ‚Äúrespira√ß√£o‚Äù leve
    for (const s of suspiros) {
      s.mesh.position.y = s.baseY + Math.sin(t * 1.4 + s.offset) * 0.09;
    }

    // leve follow da c√¢mera
    const targetX = mouse.x * 0.25;
    const targetY = 0.4 + mouse.y * 0.15;
    camera.position.x += (targetX - camera.position.x) * 0.05;
    camera.position.y += (targetY - camera.position.y) * 0.05;
    camera.lookAt(0, 0, 0);

    renderer.render(scene, camera);
  }

  animate();
</script>
